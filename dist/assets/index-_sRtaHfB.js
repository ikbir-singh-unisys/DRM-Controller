import{m as b,r as d,j as s,n as u}from"./index-DQATgoiV.js";import{b as N}from"./Urls-JdHTyFtR.js";const _=()=>{const o=b.getCookie("token");console.log("Token from cookie:",o);const[a,h]=d.useState(null),[i,m]=d.useState(null),l=localStorage.getItem("x-client-id"),r=localStorage.getItem("x-license-key"),n=l==="admin";d.useEffect(()=>{(async()=>{try{const t=await u.get(`${N}/dashboard`,{headers:{x_client_id:l||"",x_license_key:r||"","Content-Type":"application/json"}});h(t.data)}catch(t){console.error("Failed to load dashboard:",t),m("Failed to load dashboard data.")}})()},[l,r]);const c=e=>{const t=Math.floor(e/3600),x=Math.floor(e%3600/60),j=e%60;return`${t}h ${x}m ${j}s`};return s.jsxs("div",{className:"container-fluid mt-4",children:[s.jsx("h2",{className:"mb-4",children:"📊 Dashboard"}),i&&s.jsx("div",{className:"alert alert-danger",children:i}),a?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"row g-3 mb-4",children:[s.jsx("div",{className:"col-md-4",children:s.jsx("div",{className:"card border-primary shadow-sm",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h5",{className:"card-title",children:"Total Jobs"}),s.jsx("p",{className:"card-text fs-4 fw-bold",children:a.total_jobs})]})})}),s.jsx("div",{className:"col-md-4",children:s.jsx("div",{className:"card border-success shadow-sm",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h5",{className:"card-title",children:"Total Duration"}),s.jsx("p",{className:"card-text fs-5",children:c(a.total_duration_seconds)})]})})})]}),s.jsxs("div",{className:"row g-3 mb-4",children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("h5",{children:"Jobs by Status"}),s.jsx("ul",{className:"list-group",children:Object.entries(a.jobs_by_status).map(([e,t])=>s.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e,s.jsx("span",{className:"badge bg-primary rounded-pill",children:t})]},e))})]}),s.jsxs("div",{className:"col-md-6",children:[s.jsx("h5",{children:"Duration by Status"}),s.jsx("ul",{className:"list-group",children:Object.entries(a.duration_by_status_seconds).map(([e,t])=>s.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e,s.jsx("span",{className:"badge bg-success rounded-pill",children:c(t)})]},e))})]})]}),n&&a.client_summary&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"mb-3",children:"👥 Client Summary"}),s.jsxs("table",{className:"table table-striped table-bordered",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{children:"Client ID"}),s.jsx("th",{children:"Job Count"}),s.jsx("th",{children:"Total Duration"})]})}),s.jsx("tbody",{children:a.client_summary.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.client_id}),s.jsx("td",{children:e.job_count}),s.jsx("td",{children:c(e.total_duration)})]},e.client_id))})]})]}),n&&a.all_workers&&s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"mb-3",children:"🛠️ Workers"}),s.jsxs("table",{className:"table table-hover table-bordered",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Instance ID"}),s.jsx("th",{children:"IP"}),s.jsx("th",{children:"Jobs"}),s.jsx("th",{children:"Max"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Last Used"})]})}),s.jsx("tbody",{children:a.all_workers.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.name}),s.jsx("td",{children:e.instance_id}),s.jsx("td",{children:e.public_ip}),s.jsx("td",{children:e.current_jobs}),s.jsx("td",{children:e.max_jobs}),s.jsx("td",{children:s.jsx("span",{className:`badge ${e.is_active?"bg-success":"bg-secondary"}`,children:e.is_active?"Active":"Inactive"})}),s.jsx("td",{children:new Date(e.last_used).toLocaleString()})]},e.id))})]})]})]}):s.jsx("div",{className:"text-center",children:"Loading..."})]})};export{_ as default};
